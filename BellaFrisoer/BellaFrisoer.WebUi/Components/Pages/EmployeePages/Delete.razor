@page "/ansatte/slet"
@using BellaFrisoer.Application.Interfaces
@inject IEmployeeService EmployeeService
@inject NavigationManager NavigationManager

<PageTitle>Slet Ansat</PageTitle>

<h1>Slet Ansat</h1>

<p>Er du sikker på, at du vil slette denne ansat?</p>

<div>
	<hr />

	@if (Employee is null)
	{
		<p><em>Indlæser...</em></p>
	}
	else
	{
		<dl class="row">
			<dt class="col-sm-2">Fornavn</dt>
			<dd class="col-sm-10">@Employee.FirstName</dd>
		</dl>

		<dl class="row">
			<dt class="col-sm-2">Efternavn</dt>
			<dd class="col-sm-10">@Employee.LastName</dd>
		</dl>

		<dl class="row">
			<dt class="col-sm-2">Telefon Nummer</dt>
			<dd class="col-sm-10">@Employee.PhoneNumber</dd>
		</dl>

		<EditForm method="post" Model="Employee" OnValidSubmit="DeleteEmployee" FormName="delete" Enhance>
			<button type="submit" class="btn btn-danger" disabled="@(Employee is null)">Slet</button>
			|
			<a href="/ansatte">Tilbage</a>
		</EditForm>
	}
</div>

@code {
	private Employee? Employee;

	[SupplyParameterFromQuery]
	private int Id { get; set; }

	protected override async Task OnInitializedAsync()
	{
		Employee = await EmployeeService.GetEmployeeByIdAsync(Id);

		if (Employee is null)
		{
			NavigationManager.NavigateTo("notfound");
		}
	}

	private async Task DeleteEmployee()
	{
		await EmployeeService.DeleteEmployeeAsync(Id);
		NavigationManager.NavigateTo("/employees");
	}
}